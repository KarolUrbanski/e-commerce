<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> CandyCrush </title>
    <link rel="stylesheet" href="assets/imageSlider/css/style.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="assets/articleProgresBar/css/style.css">
</head>

<body>

    <header>

        <div class="container">
            <div class="row">
                <div class="col-1">
                    <nav id="menu-top">
                        <ul class="main-menu" style="margin: -10px 0 5px; ">
                            <div id="LoginPara">
                            <li class="register-login"> <a href="login.html"> Login </a> </li>
                       <li class="register-login"> <a href="register.html"> Register </a> </li>
                            </div>
                        </ul>

                    </nav>
                </div>
            </div>
            <div class="row">
                <div class="col-1">
                    <div class="logo">
                        <a href="index.html"><img height="60px" src="imgs/logo2.png"></a>
                    </div>
                    <a class="mobile-menu-icon">
                        <img height="60px"
                            src="https://icon-library.com/images/menu-button-icon/menu-button-icon-7.jpg">
                    </a>
                    <nav id="menu">
                        <ul class="main-menu">
                            <li> <a href="index.html"> Home </a> </li>
                            <li> <a href="index.html#best_sellers"> Best sellers </a> </li>
                            <li> <a href="products-cattegories.html"> All products </a> </li>
                            <li> <a href="basket.html"> Basket </a> </li>
                            <li> <a href="index.html#about_us"> About us </a> </li>
                        </ul>

                    </nav>
                    <div class="searchBox">
                        <input class="searchInput"type="text" name="" placeholder="Search">
                        <button class="searchButton" href="#">
                           <img height="20px" src="https://cdn-icons-png.flaticon.com/512/54/54481.png">
                        </button>
                    </div>
                </div>
            </div>
        </div>

    </header>
    <section id="see_also">
        <div class="row">
            <div class="col-1">
                <div class="slider">
                    <div class="slider-content" style="height: 25vh;">

                        <div id="slide-1" class="item">
                            <div class="content">
                                <h1>
                                    Checkout Sour candies
                                    last day of discount! <br>
                                    :)
                                </h1>
                                <a href="product_page.html" class="btn-standard">Check the offer!</a>
                            </div>
                        </div>

                        <div id="slide-2" class="item">
                            <div class="content">
                                <h1>
                                    Checkout Sweet candies
                                    last day of discount! <br>
                                    :)
                                </h1>
                                <a href="product_page.html" class="btn-standard">Check the offer!</a>
                            </div>
                        </div>

                        <div id="slide-3" class="item">
                            <div class="content">
                                <h1>
                                    Checkout Salty candies
                                    last day of discount! <br>
                                    :)
                                </h1>
                                <a href="product_page.html" class="btn-standard">Check the offer!</a>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </section>

    <section>

        <div class="container " style="height: 55vh;">
            <div class="row">
                <div class="col-1">
                    <h2> Register </h2>
                </div>
            </div>
            <div class="row icon-content-wraper">
               <form onsubmit="register(); return false">
<!-- return false for form not to refresh website( it is in form for email validity) --> 
                    <div class="col-2 ">
                        <div class="input-container">
                            <input type="text" id="name" name="Name" placeholder=" " required>
                            <label for="name"> First-Name:</label>
                        </div>
                     <div class="input-container">
                         <input type="text" id="last-name" name="last-name" placeholder=" " >
                         <label for="last-name"> Last-name:</label>
                    </div>
                        <div class="input-container">
                            <input type="email" id="email" name="email" placeholder=" " required>
                            <label for="password">Email:</label>
                        </div>

                        <div class="input-container">
                            <input type="password" id="password" name="password" placeholder=" ">
                            <label for="password">Password:</label>
                           
                        </div>
                        <div id="response"></div>
                        <div class="input-container">
                            <input type="password" id="conf_password" name="conf_password" placeholder=" ">
                            <label for="conf_password">Confrim Password:</label>
                        </div>

                        <div class="input-container">
                            <input type="text" id="phone" name="phone" maxlength="12" placeholder=" " required>
                            <label for="phone"> Phone </label>
                        </div>
                    </div>
                    <div class="col-2 ">
                        <div class="input-container">
                            <input id="Street" name="Street" type="text" placeholder=" " required>
                            <label for="Street">Street Address</label>
                        </div>

                        <div class="input-container">
                            <input id="Address" name="Address" type="text" placeholder=" ">
                            <label for="Address">Address Line 2</label>
                        </div>

                        <div class="input-container">
                            <input id="City" name="City" type="text" placeholder=" ">
                            <label for="City">City</label>
                        </div>

                        <div class="input-container">
                            <input id="Region" name="Region" type="text" placeholder=" ">
                            <label for="Region">State / Province / Region</label>
                        </div>

                        <div class="input-container">
                            <input id="Zip" name="Zip" maxlength="15" type="text" placeholder=" " required>
                            <label for="Zip">Postal / Zip Code</label>
                        </div>


                    </div>
                   
                    <div class="col-1 mt-60">
                   <button type="submit" id="saveForm" class="btn-standard" >Submint</button>
                    </div>
                </form>
                <div id="ServerResponse">
                </div>
            </div>
        </div>

    </section>



    <section class="divider">

        <div class="row">
            <div class="col-1">
                <h3> The best candies from around the world!</h3>
                <p> Only on our site :) </p>
            </div>
        </div>

    </section>

    <footer>

        <div class="container">
            <div class="row">
                <div class="col-2">
                    <p>&copy; 2022 www.CandyCrush.com</p>
                </div>
                <div class="col-2 text-right">
                    <p>Privacy policy</p>
                </div>
            </div>
        </div>

    </footer>

<!-- progress bar + script to it-->
<div class="article-progress-bar"></div>
<script src="assets/articleProgresBar/java/script.js"></script>

<!-- mobile menu showing after clicking it-->
<script src="js/mobile-nav.js"></script>

<!-- script for image slider to change image every 5s-->
<script src="assets/imageSlider/java/script.js"></script>

<!-- Script for checking if logged in-->
<script src="JS/check-login.js"></script>
    <!-- Script for search-->
    <script src="js/search.js"></script>

</body>

</html>
<script>
    function register(){
        if(checkPassw()){

        
        //Create request object 
        let request = new XMLHttpRequest();

        //Create event handler that specifies what should happen when server responds
        request.onload = () => {
            //Check HTTP status code
            if(request.status === 200){
                //Get data from server
                let responseData = request.responseText;

                //Add data to page
                document.getElementById("ServerResponse").innerHTML = responseData;
                toLogin();
            }
            else
                alert("Error communicating with server: " + request.status);
        };

        //Set up request with HTTP method and URL 
        request.open("POST", "registration.php");
        request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        
        //Extract registration data
        let usrName = document.getElementById("name").value;
        let usrLastName = document.getElementById("last-name").value;
        let usrEmail = document.getElementById("email").value;
        let usrPassword = document.getElementById("password").value;
        let usrPhone = document.getElementById("phone").value;
        let usrAdr1 = document.getElementById("Street").value;
        let usrAdr2 = document.getElementById("Address").value;
        let usrAdr3 = document.getElementById("Region").value;
        let usrAdr4 = document.getElementById("Zip").value;
        let usrAdr5 = document.getElementById("City").value;

        let usrAddress= usrAdr1+", " + usrAdr2+" "  + usrAdr3 + " " + usrAdr4 + " " 
        + usrAdr5;

        //Send request
        request.send("name=" + usrName+ "&lastname=" + usrLastName + "&email=" + usrEmail + "&password=" + usrPassword
        + "&phone=" + usrPhone + "&address=" + usrAddress );
       
    }
}

    //password validity
    function checkPassw(){
        let passwordInput=document.getElementById("password");
        let confirmInput=document.getElementById("conf_password");
        const regex=new RegExp("(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.{8,})");

        //checking regex
    if(!regex.test(passwordInput.value)){
       document.getElementById("response").innerHTML="<b>Wrong Password</b><br> (Password minimum length is 8, at least 1 uppercase and 1 number)";
        return false;
    }
    else{
        //checing if password maches passwordconf
        if(passwordInput.value != confirmInput.value ){
            document.getElementById("response").innerHTML="Password not matched";
            return false;
        }
        else{
            document.getElementById("response").innerHTML="";
            return true;
        }
        
        }

    }

    function toLogin(){
        setTimeout(function() {
                    window.location.replace("/e-commerce/login.html");
                   }, 3000);
                   document.querySelector('Form').style.display='none';
    }
</script>